class GW2API{constructor(){"local"==document.currentScript.src.split("?")[1].split("=")[1].split("&")[0]?this.endpoint=window.location.origin+"/api/hs/v1/gw2":this.endpoint="https://api.guildwars2.com/v2",this.lang="en",this.downloadedObjects=[],this.missingValues=[],this.replacementSkills=[],this.jewelMods=[[25,15],[20,10],[0,0],[0,0],[12]]}getAttributes(t,e){var i=0;return new Promise(((s,a)=>{var r=[];if(null!=t.details.infix_upgrade){for(var l={id:t.details.infix_upgrade.id,attributes:[]},n=0;n<t.details.infix_upgrade.attributes.length;n++)l.attributes.push({attribute:t.details.infix_upgrade.attributes[n].attribute,multiplier:(Math.floor(20*t.details.infix_upgrade.attributes[n].modifier-.5)/t.details.attribute_adjustment/20).toFixed(3)});this.downloadedObjects["itemstat_"+l.id]=l,i=l.id,s(l)}else{var o=e.getAttribute("stats");if(null!=o)i=parseInt(o),null==this.downloadedObjects["itemstat_"+i]&&r.push(this.getAPIObjects("itemstat",i))}Promise.all(r).then((t=>{for(var e=this.downloadedObjects["itemstat_"+i],a=[],r=0;r<e.attributes.length;r++)a.push(e.attributes[r].multiplier);var l=Math.max(...a);for(r=0;r<e.attributes.length;r++)e.attributes[r].multiplier<l?e.attributes[r].isMinor=!0:e.attributes[r].isMinor=!1;s(e)}))}))}mergeMissingValues(t,e){for(var i=Object.keys(e),s=0;s<i.length;s++)null==t[i[s]]&&(t[i[s]]=e[i[s]])}processAPIObject(t,e){var i=e+"_"+t.id;if(null==this.downloadedObjects[i]){var s=this.missingValues[i];null!=s&&this.mergeMissingValues(t,s),this.downloadedObjects[i]=t}}getAPIObjects(t,e){if("effect"==t&&(t="skill"),"string"!=typeof e||isNaN(e)){if("number"==typeof e)e=[e];else if("object"!=typeof e)return}else e=[parseInt(e)];return new Promise(((i,s)=>{if(e)if(0==e.length)i();else{let s=[];(async()=>{function a(t,e){return t.length?[t.slice(0,e)].concat(a(t.slice(e),e)):[]}for(a of a(e,200))await tWeb.getRequest(this.endpoint+"/"+t+"s?ids="+a.join()+"&lang="+this.lang).then((e=>{for(var i=JSON.parse(e),a=0;a<i.length;a++)this.processAPIObject(i[a],t);s.push(i)}));i(s)})()}else i()}))}}var gw2API=new GW2API;